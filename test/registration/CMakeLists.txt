VIGRA_CONFIGURE_THREADING()

if(FFTW3_FOUND)
    INCLUDE_DIRECTORIES(${SUPPRESS_WARNINGS} ${FFTW3_INCLUDE_DIR})
    ADD_DEFINITIONS(-DHasFFTW3)

    if(LEMON_FOUND)
        INCLUDE_DIRECTORIES(${SUPPRESS_WARNINGS} ${LEMON_INCLUDE_DIR})
        ADD_DEFINITIONS(-DWITH_LEMON)
        VIGRA_ADD_TEST(test_registration test.cxx LIBRARIES ${FFTW3_LIBRARIES} ${FFTW3F_LIBRARIES} ${THREADING_LIBRARIES} ${LEMON_LIBRARIES} vigraimpex)
    else()
        VIGRA_ADD_TEST(test_registration test.cxx LIBRARIES ${FFTW3_LIBRARIES} ${FFTW3F_LIBRARIES} ${THREADING_LIBRARIES} vigraimpex)
    endif()
else()
    MESSAGE(STATUS "** WARNING: fftw not found. Fourier-domain registration tests will not be executed")

    if(LEMON_FOUND)
        INCLUDE_DIRECTORIES(${SUPPRESS_WARNINGS} ${LEMON_INCLUDE_DIR})
        ADD_DEFINITIONS(-DWITH_LEMON)
        VIGRA_ADD_TEST(test_registration test.cxx LIBRARIES ${THREADING_LIBRARIES} ${LEMON_LIBRARIES} vigraimpex)
    else()
        VIGRA_ADD_TEST(test_registration test.cxx LIBRARIES ${THREADING_LIBRARIES} vigraimpex)
    endif()
endif()

VIGRA_COPY_TEST_DATA(nuernberg-1991.png nuernberg-1995.png)
