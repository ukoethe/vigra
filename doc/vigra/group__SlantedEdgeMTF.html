<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><TITLE>vigra - Camera MTF Estimation</TITLE>
<link rel=stylesheet type="text/css" href="vigra.css">
<link rel=stylesheet type="text/css" href="vigra_1_8_2.css">
<link rel="shortcut icon" href="vigra-icon.ico" />
<script type="text/javascript">
function toggleHiddenDocumentation( textID, toggleID, toggleMessage )
{ 
	if( document.getElementById(textID).style.display == 'none' )
    {
		document.getElementById(textID).style.display = 'block';
        document.getElementById(toggleID).innerHTML = "hide " + toggleMessage;
    }
    else
    {
		document.getElementById(textID).style.display = 'none';
        document.getElementById(toggleID).innerHTML = "show " + toggleMessage;
	}
    return false;
}
</script>
</head>
<body  bgcolor="#f8f0e0" link="#0040b0" vlink="#a00040">
<basefont face="Helvetica,Arial,sans-serif" size=3>
<p align=right>
[ <a href="http://hci.iwr.uni-heidelberg.de/vigra/">VIGRA Homepage</a> |
 <a href="functionindex.html">Function Index</a> |
 <a href="classes.html">Class Index</a> |
 <a href="namespaces.html">Namespaces</a> |
 <a href="files.html">File List</a> |
 <a href="index.html">Main Page</a> ]
</p>
<!-- Generated by Doxygen 1.8.3.1 -->
</div><!-- top -->
<div class="contents">
<table class="main_heading">
<tr>
<td align=left>
<A HREF ="#_details" ><IMG BORDER=0 ALT="details" title="Detailed Description" SRC="documents/pfeilGross.gif"></A>
</td>
<td width="100%">Camera MTF Estimation
</td>
<td align=right><a href="http://hci.iwr.uni-heidelberg.de/vigra/"><IMG border=0 ALT="VIGRA" SRC="documents/vigra.gif" title="VIGRA Homepage"></a></td></tr>
</table><p>

<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvigra_1_1SlantedEdgeMTFOptions.html">SlantedEdgeMTFOptions</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pass options to one of the <a class="el" href="group__SlantedEdgeMTF.html#gaff310bc50ffb7d3a60f545c2b7a7bf37">slantedEdgeMTF()</a> functions.  <a href="classvigra_1_1SlantedEdgeMTFOptions.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gab9793ce908aa2693c05ac0244d37dd20"><td class="memTemplParams" colspan="2">template&lt;class Vector &gt; </td></tr>
<tr class="memitem:gab9793ce908aa2693c05ac0244d37dd20"><td class="memTemplItemLeft" align="right" valign="top">double&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__SlantedEdgeMTF.html#gab9793ce908aa2693c05ac0244d37dd20">mtfFitGaussian</a> (Vector const &amp;mtf)</td></tr>
<tr class="memdesc:gab9793ce908aa2693c05ac0244d37dd20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fit a <a class="el" href="classvigra_1_1Gaussian.html">Gaussian</a> function to a given MTF.  <a href="#gab9793ce908aa2693c05ac0244d37dd20">More...</a><br/></td></tr>
<tr class="separator:gab9793ce908aa2693c05ac0244d37dd20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaff310bc50ffb7d3a60f545c2b7a7bf37"><td class="memTemplParams" colspan="2">template&lt;... &gt; </td></tr>
<tr class="memitem:gaff310bc50ffb7d3a60f545c2b7a7bf37"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__SlantedEdgeMTF.html#gaff310bc50ffb7d3a60f545c2b7a7bf37">slantedEdgeMTF</a> (...)</td></tr>
<tr class="memdesc:gaff310bc50ffb7d3a60f545c2b7a7bf37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine the magnitude transfer function of the camera.  <a href="#gaff310bc50ffb7d3a60f545c2b7a7bf37">More...</a><br/></td></tr>
<tr class="separator:gaff310bc50ffb7d3a60f545c2b7a7bf37"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="_details" id="details"></a><h2 class="details_section">Detailed Description</h2>
<p>Determine the magnitude transfer function (MTF) of a camera using the slanted edge method. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gaff310bc50ffb7d3a60f545c2b7a7bf37"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vigra::slantedEdgeMTF </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine the magnitude transfer function of the camera. </p>
<p>This operator estimates the magnitude transfer function (MTF) of a camera by means of the slanted edge method described in:</p>
<p>ISO Standard No. 12233: <em>"Photography - Electronic still picture cameras - Resolution measurements"</em>, 2000</p>
<p>The input must be an image that contains a single step edge with bright pixels on one side and dark pixels on the other. However, the intensity values must be neither saturated nor zero. The algorithms computes the MTF from the Fourier transform of the edge's derivative. Thus, if the actual MTF is anisotropic, the estimated MTF does actually only apply in the direction perpendicular to the edge - several edges at different orientations are required to estimate an anisotropic MTF.</p>
<p>The algorithm returns a sequence of frequency / attenuation pairs. The frequency axis is normalized so that the Nyquist frequency of the original image is 0.5. Since the edge's derivative is computed with subpixel accuracy, the attenuation can usually be computed for frequencies significantly above the Nyquist frequency as well. The MTF estimate ends at either the first zero crossing of the MTF or at frequency 1, whichever comes earlier.</p>
<p>The present implementation improves the original slanted edge algorithm according to ISO 12233 in a number of ways:</p>
<ul>
<li>
<p class="startli">The edge is not required to run nearly vertically or horizontally (i.e. with a slant of approximately 5 degrees). The algorithm will automatically compute the edge's actual angle and adjust estimates accordingly. However, it is still necessary for the edge to be somewhat slanted, because subpixel-accurate estimation of the derivative is impossible otherwise (i.e. the edge position perpendicular to the edge direction must differ by at least 1 pixel between the two ends of the edge).</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Our implementation uses a more accurate subpixel derivative algorithm. In addition, we first perform a shading correction in order to reduce possible derivative bias due to nonuniform illumination.</p>
<p class="endli"></p>
</li>
<li>
If the input image is large enough (i.e. there are at least 20 pixels on either side of the edge over the edge's entire length), our algorithm attempts to subtract the estimated noise power spectrum from the estimated MTF. </li>
</ul>
<p>The source value type <code>T1</code> must be a scalar type which is convertible to <code>double</code>. The result is written into the <em>result</em> sequence, which must be back-insertable (supports <code>push_back()</code>) and whose <code>value_type</code> must be constructible from two <code>double</code> values. Algorithm options can be set via the <em>options</em> object (see <a class="el" href="classvigra_1_1NoiseNormalizationOptions.html">vigra::NoiseNormalizationOptions</a> for details).</p>
<p><b> Declarations:</b></p>
<p>pass 2D array views: </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> T1, <span class="keyword">class</span> S1, <span class="keyword">class</span> BackInsertable&gt;</div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">    <a class="code" href="group__SlantedEdgeMTF.html#gaff310bc50ffb7d3a60f545c2b7a7bf37" title="Determine the magnitude transfer function of the camera.">slantedEdgeMTF</a>(MultiArrayView&lt;2, T1, S1&gt; <span class="keyword">const</span> &amp; src, BackInsertable &amp; mtf,</div>
<div class="line">                   SlantedEdgeMTFOptions <span class="keyword">const</span> &amp; options = SlantedEdgeMTFOptions());</div>
<div class="line">}</div>
</div><!-- fragment --><p><a href="#" id="slantedEdgeMTF_OldAPIToggle" onclick="return toggleHiddenDocumentation(&apos;slantedEdgeMTF_OldAPI&apos;, &apos;slantedEdgeMTF_OldAPIToggle&apos;, &apos;deprecated declarations&apos;);">show deprecated declarations</a></p>
<div id="slantedEdgeMTF_OldAPI" style="display:none"> pass <a class="el" href="group__ImageIterators.html">Image Iterators</a> and <a class="el" href="group__DataAccessors.html">Data Accessors</a> : </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> SrcIterator, <span class="keyword">class</span> SrcAccessor, <span class="keyword">class</span> BackInsertable&gt;</div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">    <a class="code" href="group__SlantedEdgeMTF.html#gaff310bc50ffb7d3a60f545c2b7a7bf37" title="Determine the magnitude transfer function of the camera.">slantedEdgeMTF</a>(SrcIterator sul, SrcIterator slr, SrcAccessor src, BackInsertable &amp; mtf,</div>
<div class="line">                   SlantedEdgeMTFOptions <span class="keyword">const</span> &amp; options = SlantedEdgeMTFOptions());</div>
<div class="line">}</div>
</div><!-- fragment --><p> use argument objects in conjunction with <a class="el" href="ArgumentObjectFactories.html">Argument Object Factories</a> : </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> SrcIterator, <span class="keyword">class</span> SrcAccessor, <span class="keyword">class</span> BackInsertable&gt;</div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">    <a class="code" href="group__SlantedEdgeMTF.html#gaff310bc50ffb7d3a60f545c2b7a7bf37" title="Determine the magnitude transfer function of the camera.">slantedEdgeMTF</a>(triple&lt;SrcIterator, SrcIterator, SrcAccessor&gt; src, BackInsertable &amp; mtf,</div>
<div class="line">                   SlantedEdgeMTFOptions <span class="keyword">const</span> &amp; options = SlantedEdgeMTFOptions())</div>
<div class="line">}</div>
</div><!-- fragment --> </div><p><b> Usage:</b></p>
<p><b>#include</b> &lt;<a class="el" href="slanted__edge__mtf_8hxx_source.html">vigra/slanted_edge_mtf.hxx</a>&gt;<br/>
 Namespace: vigra</p>
<div class="fragment"><div class="line">MultiArray&lt;2, float&gt; src(w,h);</div>
<div class="line">std::vector&lt;vigra::TinyVector&lt;double, 2&gt; &gt; mtf;</div>
<div class="line"></div>
<div class="line">...</div>
<div class="line"><span class="comment">// keep all options at their default values</span></div>
<div class="line">slantedEdgeMTF(src, mtf);</div>
<div class="line"></div>
<div class="line"><span class="comment">// print the frequency / attenuation pairs found</span></div>
<div class="line"><span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;result.size(); ++k)</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;frequency: &quot;</span> &lt;&lt; mtf[k][0] &lt;&lt; <span class="stringliteral">&quot;, estimated attenuation: &quot;</span> &lt;&lt; mtf[k][1] &lt;&lt; std::endl;</div>
</div><!-- fragment --><p><a href="#" id="slantedEdgeMTF_OldUsageToggle" onclick="return toggleHiddenDocumentation(&apos;slantedEdgeMTF_OldUsage&apos;, &apos;slantedEdgeMTF_OldUsageToggle&apos;, &apos;deprecated examples&apos;);">show deprecated examples</a></p>
<div id="slantedEdgeMTF_OldUsage" style="display:none"> <div class="fragment"><div class="line"><a class="code" href="classvigra_1_1BasicImage.html" title="Fundamental class template for images.">vigra::BImage</a> src(w,h);</div>
<div class="line">std::vector&lt;vigra::TinyVector&lt;double, 2&gt; &gt; mtf;</div>
<div class="line"></div>
<div class="line">...</div>
<div class="line">vigra::slantedEdgeMTF(srcImageRange(src), mtf);</div>
<div class="line"></div>
<div class="line"><span class="comment">// print the frequency / attenuation pairs found</span></div>
<div class="line"><span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;result.size(); ++k)</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;frequency: &quot;</span> &lt;&lt; mtf[k][0] &lt;&lt; <span class="stringliteral">&quot;, estimated attenuation: &quot;</span> &lt;&lt; mtf[k][1] &lt;&lt; std::endl;</div>
</div><!-- fragment --><p> <b> Required Interface:</b> </p>
<div class="fragment"><div class="line">SrcIterator upperleft, lowerright;</div>
<div class="line">SrcAccessor src;</div>
<div class="line"></div>
<div class="line"><span class="keyword">typedef</span> SrcAccessor::value_type SrcType;</div>
<div class="line"><span class="keyword">typedef</span> NumericTraits&lt;SrcType&gt;::isScalar isScalar;</div>
<div class="line">assert(isScalar::asBool == <span class="keyword">true</span>);</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">double</span> value = src(uperleft);</div>
<div class="line"></div>
<div class="line">BackInsertable result;</div>
<div class="line"><span class="keyword">typedef</span> BackInsertable::value_type ResultType;    </div>
<div class="line"><span class="keywordtype">double</span> intensity, variance;</div>
<div class="line">result.push_back(ResultType(intensity, variance));</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="gab9793ce908aa2693c05ac0244d37dd20"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double vigra::mtfFitGaussian </td>
          <td>(</td>
          <td class="paramtype">Vector const &amp;&#160;</td>
          <td class="paramname"><em>mtf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fit a <a class="el" href="classvigra_1_1Gaussian.html">Gaussian</a> function to a given MTF. </p>
<p>This function expects a sequence of frequency / attenuation pairs as produced by <a class="el" href="group__SlantedEdgeMTF.html#gaff310bc50ffb7d3a60f545c2b7a7bf37">slantedEdgeMTF()</a> and finds the best fitting <a class="el" href="classvigra_1_1Gaussian.html">Gaussian</a> point spread function (<a class="el" href="classvigra_1_1Gaussian.html">Gaussian</a> functions are good approximations of the PSF of many real cameras). It returns the standard deviation (scale) of this function. The algorithm computes the standard deviation by means of a linear least square on the logarithm of the MTF, i.e. an algebraic fit rather than a Euclidean fit - thus, the resulting <a class="el" href="classvigra_1_1Gaussian.html">Gaussian</a> may not be the one that intuitively fits the data optimally.</p>
<p><b> Declaration:</b></p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> Vector&gt;</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="group__SlantedEdgeMTF.html#gab9793ce908aa2693c05ac0244d37dd20" title="Fit a Gaussian function to a given MTF.">mtfFitGaussian</a>(Vector <span class="keyword">const</span> &amp; mtf);</div>
<div class="line">}</div>
</div><!-- fragment --><p><b> Usage:</b></p>
<p><b>#include</b> &lt;<a class="el" href="slanted__edge__mtf_8hxx_source.html">vigra/slanted_edge_mtf.hxx</a>&gt;<br/>
 Namespace: vigra</p>
<div class="fragment"><div class="line">MultiArray&lt;2, float&gt; src(w,h);</div>
<div class="line">std::vector&lt;vigra::TinyVector&lt;double, 2&gt; &gt; mtf;</div>
<div class="line"></div>
<div class="line">...</div>
<div class="line">slantedEdgeMTF(src, mtf);</div>
<div class="line"><span class="keywordtype">double</span> scale = <a class="code" href="group__SlantedEdgeMTF.html#gab9793ce908aa2693c05ac0244d37dd20" title="Fit a Gaussian function to a given MTF.">vigra::mtfFitGaussian</a>(mtf)</div>
<div class="line"></div>
<div class="line">std::cout &lt;&lt; &quot;The camera PSF is approximately a Gaussian at scale &quot; &lt;&lt; scale &lt;&lt; std::endl;</div>
</div><!-- fragment --><p><b> Required Interface:</b></p>
<div class="fragment"><div class="line">Vector mtf;</div>
<div class="line"><span class="keywordtype">int</span> numberOfMeasurements = mtf.size()</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">double</span> frequency = mtf[0][0];</div>
<div class="line"><span class="keywordtype">double</span> attenuation = mtf[0][1];</div>
</div><!-- fragment --> 
</div>
</div>
</div><!-- contents -->
<!-- footer.html -->
<p>
<table border=0 cellspacing=0 width="100%"  bgcolor="#e0d0a0" cellpadding=5>
<tr>
<td>
<p>
<i>&copy; <A HREF="http://hci.iwr.uni-heidelberg.de/people/ukoethe/">Ullrich K&ouml;the</A>     (<A
HREF="mailto:ullrich.koethe@iwr.uni-heidelberg.de">ullrich.koethe@iwr.uni-heidelberg.de</A>)</i> <br>
<i><A HREF="http://hci.iwr.uni-heidelberg.de/">
Heidelberg Collaboratory for Image Processing</a>,
University of Heidelberg, Germany</i>
<td>
<p align=right>
<I>html generated using <A HREF="http://www.doxygen.org">doxygen</A> and <A HREF="http://www.python.org">Python</A></I>
<br>
<i>
vigra 1.9.1 (Thu Sep 5 2013)
</i>
</tr>
</table>
</BODY>
</HTML>
